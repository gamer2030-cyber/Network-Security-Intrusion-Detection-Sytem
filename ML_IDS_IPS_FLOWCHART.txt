╔════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                                      ML-IDS-IPS SYSTEM FLOWCHART                                                         ║
╚════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝


                                    ┌─────────────────────┐
                                    │       START         │
                                    │  System Initialized │
                                    └──────────┬──────────┘
                                               │
                                               ▼
                                    ┌─────────────────────┐
                                    │  Start Infrastructure│
                                    │  • Docker Services   │
                                    │  • Kafka, Redis, ZK  │
                                    └──────────┬──────────┘
                                               │
                                               ▼
                                    ┌─────────────────────┐
                                    │  Start Monitoring    │
                                    │  • Packet Capture    │
                                    │  • URL Detector      │
                                    │  • Honeypot System   │
                                    └──────────┬──────────┘
                                               │
                                               ▼
                    ┌─────────────────────────────────────────────────────────┐
                    │                                                         │
                    │              ┌─────────────────────┐                    │
                    │              │  Network Traffic    │                    │
                    │              │  (Continuous Flow)  │                    │
                    │              └──────────┬──────────┘                    │
                    │                         │                                │
                    │                         ▼                                │
                    │              ┌─────────────────────┐                    │
                    │              │  PACKET CAPTURE      │                    │
                    │              │  (Scapy Library)     │                    │
                    │              │  • TCP, UDP, ICMP   │                    │
                    │              │  • HTTP, HTTPS, DNS │                    │
                    │              │  • All Protocols     │                    │
                    │              └──────────┬──────────┘                    │
                    │                         │                                │
                    │                         ▼                                │
                    │              ┌─────────────────────┐                    │
                    │              │  Packet Received?   │                    │
                    │              └──────────┬──────────┘                    │
                    │                         │                                │
                    │                    YES  │                                │
                    │                         ▼                                │
                    │              ┌─────────────────────┐                    │
                    │              │  FEATURE EXTRACTION  │                    │
                    │              │  • Source IP/Port   │                    │
                    │              │  • Dest IP/Port    │                    │
                    │              │  • Protocol Type    │                    │
                    │              │  • Packet Size      │                    │
                    │              │  • Flags, TTL       │                    │
                    │              │  • Service Type     │                    │
                    │              │  • Flow Statistics  │                    │
                    │              │  • 40+ Features     │                    │
                    │              └──────────┬──────────┘                    │
                    │                         │                                │
                    │                         ▼                                │
                    │         ┌───────────────────────────────────┐            │
                    │         │                                   │            │
                    │         ▼                                   ▼            │
                    │  ┌──────────────────┐          ┌─────────────────────┐  │
                    │  │ Store Raw Packet│          │ Store Features      │  │
                    │  │ in Kafka Topic: │          │ in Kafka Topic:     │  │
                    │  │ network_packets │          │ ml_predictions      │  │
                    │  └────────┬────────┘          └──────────┬──────────┘  │
                    │           │                              │              │
                    │           └──────────────┬───────────────┘              │
                    │                          │                               │
                    │                          ▼                               │
                    │              ┌─────────────────────┐                    │
                    │              │  ML MODEL PREDICTION │                    │
                    │              │  (4 Models Parallel) │                    │
                    │              └──────────┬──────────┘                    │
                    │                         │                                │
                    │                         ▼                                │
                    │         ┌───────────────────────────────────┐            │
                    │         │                                   │            │
                    │         ▼                                   ▼            │
                    │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
                    │  │ Random Forest│  │Gradient Boost│  │     SVM      │  │
                    │  │ (NSL-KDD)    │  │ (CICIDS2017) │  │ (NSL-KDD)    │  │
                    │  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  │
                    │         │                  │                 │          │
                    │         └──────────────────┴─────────────────┘          │
                    │                          │                               │
                    │                          ▼                               │
                    │              ┌─────────────────────┐                    │
                    │              │  Prediction Result  │                    │
                    │              │  • Normal (0)       │                    │
                    │              │  • Attack (1)        │                    │
                    │              │  • Confidence %      │                    │
                    │              └──────────┬──────────┘                    │
                    │                         │                                │
                    │                         ▼                                │
                    │              ┌─────────────────────┐                    │
                    │              │  Confidence ≥ 70%?  │                    │
                    │              └──────────┬──────────┘                    │
                    │                         │                                │
                    │              ┌──────────┴──────────┐                    │
                    │         YES  │                     │  NO                 │
                    │              ▼                     ▼                    │
                    │  ┌──────────────────┐   ┌─────────────────────┐        │
                    │  │ ML Threat Alert  │   │  Log Normal Traffic │        │
                    │  │ • Severity: HIGH │   │  Continue Monitoring│        │
                    │  │   MEDIUM/LOW     │   └─────────────────────┘        │
                    │  └──────────┬───────┘                                   │
                    │             │                                            │
                    │             ▼                                            │
                    │  ┌─────────────────────┐                                │
                    │  │ Send to Kafka Topic:│                                │
                    │  │ security_alerts     │                                │
                    │  └──────────┬──────────┘                                │
                    │             │                                            │
                    │             └────────────────────────────────────────────┘
                    │
                    │
                    │  ┌──────────────────────────────────────────────────────┐
                    │  │                                                      │
                    │  │              ┌─────────────────────┐                │
                    │  │              │  URL THREAT DETECTOR │                │
                    │  │              │  (Parallel Process)  │                │
                    │  │              └──────────┬──────────┘                │
                    │  │                         │                            │
                    │  │                         ▼                            │
                    │  │              ┌─────────────────────┐                │
                    │  │              │  Monitor DNS/HTTP    │                │
                    │  │              │  • Domain Lookups   │                │
                    │  │              │  • HTTP Requests    │                │
                    │  │              └──────────┬──────────┘                │
                    │  │                         │                            │
                    │  │                         ▼                            │
                    │  │              ┌─────────────────────┐                │
                    │  │              │  Check Threat Intel  │                │
                    │  │              │  • Malicious Domains │                │
                    │  │              │  • Suspicious URLs  │                │
                    │  │              └──────────┬──────────┘                │
                    │  │                         │                            │
                    │  │                         ▼                            │
                    │  │              ┌─────────────────────┐                │
                    │  │              │  Threat Found?      │                │
                    │  │              └──────────┬──────────┘                │
                    │  │                         │                            │
                    │  │              ┌──────────┴──────────┐                │
                    │  │         YES  │                     │  NO             │
                    │  │              ▼                     ▼                │
                    │  │  ┌──────────────────┐   ┌─────────────────────┐    │
                    │  │  │ URL Threat Alert │   │  Continue Monitoring│    │
                    │  │  │ • Badge: 🌐      │   └─────────────────────┘    │
                    │  │  └──────────┬───────┘                               │
                    │  │             │                                        │
                    │  │             ▼                                        │
                    │  │  ┌─────────────────────┐                            │
                    │  │  │ Send to Kafka Topic:│                            │
                    │  │  │ security_alerts     │                            │
                    │  │  └─────────────────────┘                            │
                    │  │                                                      │
                    │  └──────────────────────────────────────────────────────┘
                    │
                    │
                    │  ┌──────────────────────────────────────────────────────┐
                    │  │                                                      │
                    │  │              ┌─────────────────────┐                │
                    │  │              │  HONEYPOT SYSTEM     │                │
                    │  │              │  (Parallel Process)  │                │
                    │  │              └──────────┬──────────┘                │
                    │  │                         │                            │
                    │  │                         ▼                            │
                    │  │              ┌─────────────────────┐                │
                    │  │              │  Fake Services:      │                │
                    │  │              │  • SSH (2222)        │                │
                    │  │              │  • HTTP (8080)       │                │
                    │  │              │  • FTP (2121)        │                │
                    │  │              │  • Telnet (2323)     │                │
                    │  │              │  • MySQL (3307)      │                │
                    │  │              └──────────┬──────────┘                │
                    │  │                         │                            │
                    │  │                         ▼                            │
                    │  │              ┌─────────────────────┐                │
                    │  │              │  Connection Attempt?│                │
                    │  │              └──────────┬──────────┘                │
                    │  │                         │                            │
                    │  │              ┌──────────┴──────────┐                │
                    │  │         YES  │                     │  NO             │
                    │  │              ▼                     ▼                │
                    │  │  ┌──────────────────┐   ┌─────────────────────┐    │
                    │  │  │ Honeypot Alert   │   │  Continue Monitoring│    │
                    │  │  │ • Badge: 🎣      │   └─────────────────────┘    │
                    │  │  │ • 100% Confirmed │                               │
                    │  │  │   Attacker       │                               │
                    │  │  └──────────┬───────┘                               │
                    │  │             │                                        │
                    │  │             ▼                                        │
                    │  │  ┌─────────────────────┐                            │
                    │  │  │ Send to Kafka Topic:│                            │
                    │  │  │ security_alerts       │                            │
                    │  │  └─────────────────────┘                            │
                    │  │                                                      │
                    │  └──────────────────────────────────────────────────────┘
                    │
                    │
                    └─────────────────────────────────────────────────────────┘
                                               │
                                               │ All Alerts
                                               ▼
                                    ┌─────────────────────┐
                                    │  KAFKA: security_    │
                                    │  alerts Topic        │
                                    └──────────┬──────────┘
                                               │
                                               ▼
                                    ┌─────────────────────┐
                                    │  REDIS CACHE        │
                                    │  • Store Alerts     │
                                    │  • Store Statistics │
                                    │  • Fast Retrieval   │
                                    └──────────┬──────────┘
                                               │
                                               ▼
                                    ┌─────────────────────┐
                                    │  DASHBOARD PROCESS   │
                                    │  production_dashboard│
                                    │  .py                │
                                    │  • Read from Kafka   │
                                    │  • Process Alerts    │
                                    │  • Update Statistics │
                                    └──────────┬──────────┘
                                               │
                                               ▼
                                    ┌─────────────────────┐
                                    │  WEBSOCKET          │
                                    │  (Socket.IO)        │
                                    │  • Real-time Push   │
                                    │  • Every 2 seconds  │
                                    └──────────┬──────────┘
                                               │
                                               ▼
                                    ┌─────────────────────┐
                                    │  WEB DASHBOARD       │
                                    │  (Browser)           │
                                    │  http://localhost:   │
                                    │  5050                │
                                    └──────────┬──────────┘
                                               │
                                               ▼
                                    ┌─────────────────────┐
                                    │  USER SEES ALERTS    │
                                    │  • Real-time Display │
                                    │  • Color-coded       │
                                    │  • Interactive       │
                                    │  • Charts & Stats    │
                                    └──────────┬──────────┘
                                               │
                                               ▼
                                    ┌─────────────────────┐
                                    │  CONTINUE MONITORING│
                                    │  (Loop Back)        │
                                    └──────────┬──────────┘
                                               │
                                               └──────────────┐
                                                              │
                                                              ▼
                                    ┌─────────────────────────────────┐
                                    │  System Running Continuously    │
                                    │  Until Stopped                  │
                                    └─────────────────────────────────┘


════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

                                    DECISION POINTS SUMMARY

┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  1. Packet Received?          → YES: Extract Features  |  NO: Continue Monitoring                                                │
│  2. Confidence ≥ 70%?         → YES: Generate Alert    |  NO: Log Normal Traffic                                                 │
│  3. URL Threat Found?         → YES: Generate Alert    |  NO: Continue Monitoring                                                │
│  4. Honeypot Connection?      → YES: Generate Alert    |  NO: Continue Monitoring                                                │
│  5. System Running?           → YES: Loop Back         |  NO: Stop System                                                         │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

                                    PARALLEL PROCESSES

┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  Process 1:  Packet Capture → Feature Extraction → ML Prediction → Threat Detection                                              │
│  Process 2:  URL Threat Detector (Independent, monitors DNS/HTTP)                                                               │
│  Process 3:  Honeypot System (Independent, monitors fake services)                                                               │
│  Process 4:  Dashboard (Reads from Kafka, pushes to browser via WebSocket)                                                       │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

                                    DATA STORAGE POINTS

┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  Kafka Topic: network_packets    → Raw packet data (batches of 100)                                                              │
│  Kafka Topic: ml_predictions     → ML model predictions with features                                                               │
│  Kafka Topic: security_alerts    → All security alerts (ML, URL, Honeypot)                                                       │
│  Redis Cache                     → Recent alerts, statistics, session data                                                        │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

                                    FLOWCHART SYMBOLS LEGEND

┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  ┌─────────┐  Process/Operation  →  Action performed by system                                                                   │
│  │         │                                                                                                                      │
│  └─────────┘                                                                                                                     │
│                                                                                                                                    │
│  ◇─────────◇  Decision Point      →  Yes/No question, branches flow                                                               │
│                                                                                                                                    │
│  ───────────→  Flow Arrow         →  Direction of data/process flow                                                               │
│                                                                                                                                    │
│  ═══════════  Data Storage        →  Kafka topics, Redis cache                                                                    │
│                                                                                                                                    │
│  ┌─────────┐  Input/Output        →  User interaction, external data                                                             │
│  │         │                                                                                                                      │
│  └─────────┘                                                                                                                     │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

